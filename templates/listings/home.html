{% extends "base.html" %}
{% load static %}
{% load humanize %}

{% block content %}
<div class="home-layout">
    <!-- Left Column: Welcome -->
    <section class="welcome-column">
        <h1 class="welcome-main-title">Welcome to AdVance Home Real Estate!</h1>
        <h2 class="welcome-sub-title">Local expertise you can trust.</h2>

        <p class="welcome-paragraph">
            At AdVance Home Real Estate, we help you move forward with confidence. Whether you're searching for a place to call home or simply exploring the Omaha real estate market, Madison Vance is here to guide you every step of the way. With years of experience and a deep understanding of Omaha's neighborhoods, Madison is dedicated to helping you find the home that's right for you.
        </p>

        <div class="welcome-logo-bottom">
            <img src="{% static 'images/logo.png' %}" alt="AdVance Real Estate">
        </div>
    </section>

    <!-- Right Column: Featured Property -->
    <section class="featured-column">
        <div class="featured-image-container">
            {% if featured_listing and featured_listing.photos.first %}
                {% if featured_listing.photos.first.image_data %}
                    <img src="{% url 'listing_photo' featured_listing.photos.first.photo_id %}" alt="{{ featured_listing.address }}">
                {% else %}
                    <img src="https://placehold.co/800x600?text=Featured+Home" alt="{{ featured_listing.address }}">
                {% endif %}
            {% else %}
                <img src="https://placehold.co/800x600?text=Featured+Home" alt="Featured Home">
            {% endif %}
        </div>

        <div class="featured-details-container">
            <h2 class="featured-title">Featured Home of the Week!</h2>
            {% if featured_listing %}
                <h3 class="featured-address-large">{{ featured_listing.address }}</h3>
                <p class="featured-price-large">${{ featured_listing.price|intcomma }}</p>
                <div class="featured-details-row">
                    <span>{{ featured_listing.bedrooms }} Bed</span> &bull;
                    <span>{{ featured_listing.bathrooms }} Bath</span> &bull;
                    <span>{{ featured_listing.square_footage|intcomma }} SqFt</span>
                </div>
                <p class="featured-sub-details">{{ featured_listing.property_type.name }} &bull; {{ featured_listing.neighborhood.name }}</p>
                
                <p class="featured-desc-text">
                    {{ featured_listing.description|truncatechars:150 }}
                </p>
                
                <div class="featured-buttons">
                    <a href="{% url 'listings' %}" class="view-listing-btn">View full listings</a>
                    {% if user.is_authenticated %}
                        <a href="{% url 'featured_listing_update' %}" class="update-featured-btn">
                            {% if is_featured_sold %}
                                <i class="bi bi-exclamation-triangle-fill"></i>
                            {% endif %}
                            Update Featured
                        </a>
                    {% endif %}
                </div>
            {% else %}
                <h3 class="featured-address-large">No featured listing selected</h3>
                <p class="featured-desc-text">
                    Check back soon for our home of the week!
                </p>
                {% if user.is_authenticated %}
                    <a href="{% url 'featured_listing_update' %}" class="view-listing-btn">Select Featured Property</a>
                {% endif %}
            {% endif %}
        </div>
    </section>
{% endblock %}
